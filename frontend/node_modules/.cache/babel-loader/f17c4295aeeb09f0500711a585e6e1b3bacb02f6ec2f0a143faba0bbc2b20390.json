{"ast":null,"code":"import React,{useState}from'react';import styled from'styled-components';import{useSearch}from'../App';import ProductsTable from'../components/products/ProductsTable';import{useQuery}from'react-query';import{fetchProducts,fetchProductFilters}from'../services/productService';import ProductFiltersComponent from'../components/filters/ProductFilters';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TabContainer=styled.div`\n  display: flex;\n  flex-direction: column;\n  height: calc(100% - 20px);\n  padding-top: 10px;\n`;const MainContentArea=styled.div`\n  width: 100%;\n  height: 100%;\n`;const FiltersContainer=styled.div`\n  margin-bottom: 20px;\n`;// Інтерфейс для продуктів\nconst ProductsTab=()=>{const{searchTerm}=useSearch();const[page,setPage]=useState(1);const[perPage,setPerPage]=useState(20);const[filters,setFilters]=useState({search:searchTerm||undefined,visible_only:false,only_unsold:false});// Оновлюємо фільтр пошукового запиту кожного разу, коли змінюється searchTerm\nReact.useEffect(()=>{setFilters(prev=>({...prev,search:searchTerm||undefined}));},[searchTerm]);// Запит на отримання фільтрів\nconst{data:filtersData,isLoading:isLoadingFilters}=useQuery('productFilters',fetchProductFilters);// Запит на отримання продуктів з відповідними фільтрами та пагінацією\nconst{data:productsData,isLoading:isLoadingProducts,refetch}=useQuery(['products',page,perPage,filters],()=>fetchProducts(page,perPage,filters),{keepPreviousData:true});// Обробка зміни фільтрів\nconst handleFilterChange=newFilters=>{setFilters(prev=>({...prev,...newFilters}));setPage(1);// Скидаємо пагінацію при зміні фільтрів\n};// Обробка зміни сторінки\nconst handlePageChange=newPage=>{setPage(newPage);};// Обробники дій з продуктами\nconst handleViewProduct=productId=>{console.log('View product',productId);};const handleEditProduct=productId=>{console.log('Edit product',productId);};const handleDeleteProduct=productId=>{console.log('Delete product',productId);};const handleToggleVisibility=productId=>{console.log('Toggle visibility',productId);// Тут можна додати виклик API для перемикання видимості\nrefetch();// Оновлюємо дані після зміни\n};// Якщо дані завантажуються, показуємо завантажувач\nif(isLoadingProducts&&!productsData){return/*#__PURE__*/_jsx(\"div\",{children:\"\\u0417\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0435\\u043D\\u043D\\u044F \\u043F\\u0440\\u043E\\u0434\\u0443\\u043A\\u0442\\u0456\\u0432...\"});}return/*#__PURE__*/_jsxs(TabContainer,{children:[filtersData&&/*#__PURE__*/_jsx(FiltersContainer,{children:/*#__PURE__*/_jsx(ProductFiltersComponent,{filters:filtersData,selectedFilters:filters,onFilterChange:handleFilterChange})}),/*#__PURE__*/_jsx(MainContentArea,{children:productsData&&/*#__PURE__*/_jsx(ProductsTable,{products:productsData.items,onViewProduct:handleViewProduct,onEditProduct:handleEditProduct,onDeleteProduct:handleDeleteProduct,onToggleVisibility:handleToggleVisibility,totalItems:productsData.total,currentPage:page,perPage:perPage,totalPages:productsData.pages,onPageChange:handlePageChange})})]});};export default ProductsTab;","map":{"version":3,"names":["React","useState","styled","useSearch","ProductsTable","useQuery","fetchProducts","fetchProductFilters","ProductFiltersComponent","jsx","_jsx","jsxs","_jsxs","TabContainer","div","MainContentArea","FiltersContainer","ProductsTab","searchTerm","page","setPage","perPage","setPerPage","filters","setFilters","search","undefined","visible_only","only_unsold","useEffect","prev","data","filtersData","isLoading","isLoadingFilters","productsData","isLoadingProducts","refetch","keepPreviousData","handleFilterChange","newFilters","handlePageChange","newPage","handleViewProduct","productId","console","log","handleEditProduct","handleDeleteProduct","handleToggleVisibility","children","selectedFilters","onFilterChange","products","items","onViewProduct","onEditProduct","onDeleteProduct","onToggleVisibility","totalItems","total","currentPage","totalPages","pages","onPageChange"],"sources":["/Users/i.malashenko/Desktop/project копія/react-fastapi-app/frontend/src/pages/ProductsTab.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport styled from 'styled-components';\nimport { useSearch } from '../App';\nimport ProductsTable from '../components/products/ProductsTable';\nimport { useQuery } from 'react-query';\nimport { fetchProducts, fetchProductFilters, ProductFilters } from '../services/productService';\nimport ProductFiltersComponent from '../components/filters/ProductFilters';\n\nconst TabContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: calc(100% - 20px);\n  padding-top: 10px;\n`;\n\nconst MainContentArea = styled.div`\n  width: 100%;\n  height: 100%;\n`;\n\nconst FiltersContainer = styled.div`\n  margin-bottom: 20px;\n`;\n\n// Інтерфейс для продуктів\ninterface Product {\n  id: number;\n  productnumber: string;\n  clones?: string | null;\n  typename: string | null;\n  subtypename: string | null;\n  brandname: string | null;\n  model: string | null;\n  marking?: string | null;\n  gender?: string | null;\n  color: string | null;\n  description: string | null;\n  country: string | null;\n  manufacturer?: string | null;\n  size: string | null;\n  dimensions: string | null;\n  price: number;\n  oldprice: number | null;\n  statusname: string | null;\n  conditionname: string | null;\n  additional_note?: string | null;\n  import_status: string | null;\n  quantity: number;\n  image_url: string | null;\n  is_visible: boolean;\n  created_at: string;\n  updated_at: string;\n}\n\nconst ProductsTab: React.FC = () => {\n  const { searchTerm } = useSearch();\n  const [page, setPage] = useState(1);\n  const [perPage, setPerPage] = useState(20);\n  const [filters, setFilters] = useState<ProductFilters>({\n    search: searchTerm || undefined,\n    visible_only: false,\n    only_unsold: false\n  });\n\n  // Оновлюємо фільтр пошукового запиту кожного разу, коли змінюється searchTerm\n  React.useEffect(() => {\n    setFilters(prev => ({ ...prev, search: searchTerm || undefined }));\n  }, [searchTerm]);\n\n  // Запит на отримання фільтрів\n  const { data: filtersData, isLoading: isLoadingFilters } = useQuery(\n    'productFilters',\n    fetchProductFilters\n  );\n\n  // Запит на отримання продуктів з відповідними фільтрами та пагінацією\n  const { data: productsData, isLoading: isLoadingProducts, refetch } = useQuery(\n    ['products', page, perPage, filters],\n    () => fetchProducts(page, perPage, filters),\n    { keepPreviousData: true }\n  );\n\n  // Обробка зміни фільтрів\n  const handleFilterChange = (newFilters: ProductFilters) => {\n    setFilters(prev => ({ ...prev, ...newFilters }));\n    setPage(1); // Скидаємо пагінацію при зміні фільтрів\n  };\n\n  // Обробка зміни сторінки\n  const handlePageChange = (newPage: number) => {\n    setPage(newPage);\n  };\n\n  // Обробники дій з продуктами\n  const handleViewProduct = (productId: number) => {\n    console.log('View product', productId);\n  };\n\n  const handleEditProduct = (productId: number) => {\n    console.log('Edit product', productId);\n  };\n\n  const handleDeleteProduct = (productId: number) => {\n    console.log('Delete product', productId);\n  };\n\n  const handleToggleVisibility = (productId: number) => {\n    console.log('Toggle visibility', productId);\n    // Тут можна додати виклик API для перемикання видимості\n    refetch(); // Оновлюємо дані після зміни\n  };\n\n  // Якщо дані завантажуються, показуємо завантажувач\n  if (isLoadingProducts && !productsData) {\n    return <div>Завантаження продуктів...</div>;\n  }\n\n  return (\n    <TabContainer>\n      {filtersData && (\n        <FiltersContainer>\n          <ProductFiltersComponent\n            filters={filtersData}\n            selectedFilters={filters}\n            onFilterChange={handleFilterChange}\n          />\n        </FiltersContainer>\n      )}\n      <MainContentArea>\n        {productsData && (\n          <ProductsTable \n            products={productsData.items}\n            onViewProduct={handleViewProduct}\n            onEditProduct={handleEditProduct}\n            onDeleteProduct={handleDeleteProduct}\n            onToggleVisibility={handleToggleVisibility}\n            totalItems={productsData.total}\n            currentPage={page}\n            perPage={perPage}\n            totalPages={productsData.pages}\n            onPageChange={handlePageChange}\n          />\n        )}\n      </MainContentArea>\n    </TabContainer>\n  );\n};\n\nexport default ProductsTab; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}